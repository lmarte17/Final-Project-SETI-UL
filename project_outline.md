# Final Project Outline  
**Classical Unsupervised Analysis of SETI Spectrograms**  

---

## 1. Data Gathering & Provenance (3 pts)  
1. **Data Source**  
   - Kaggle dataset: `tentotheminus9/seti-data`  
   - Download command (example):  
     ```bash
     kaggle datasets download -d tentotheminus9/seti-data --unzip -p data/raw/
     ```  
   - Download date: 2025-04-23  

2. **Directory Layout**  
```
/data/
raw/         ← original PNGs by class
processed/   ← cleaned & resized images
/notebooks/
/src/
/outputs/
```

3. **Provenance & Licensing**  
   - Generated by Breakthrough Listen team for research  
   - Public domain, no PII  

4. **Ingestion Script**  
   - `src/load_data.py`:  
     - Scans `data/raw/` for subfolders  
     - Verifies image integrity (file size > 0)  
     - Copies to `data/processed/`  

---

## 2. Problem Definition (6 pts)  
1. **Primary Task**:  
   - **Anomaly detection**: learn "noise" distribution → flag any spectrogram differing from noise.  

2. **Secondary Task**:  
   - **Clustering** of the 7 signal types (exploratory).  

3. **Algorithms to Use**:  
   - **Feature extraction**: flattened pixels, spectral-band summaries  
   - **Dimensionality reduction**: PCA, optionally t-SNE/UMAP for visualization  
   - **Clustering**: K-Means, Hierarchical (Ward), DBSCAN  
   - **Matrix factorization**: SVD, NMF on image matrices  
   - **Similarity**: Cosine, Jaccard on feature vectors  

4. **Success Metrics**:  
   - Stage 1: Anomaly ROC AUC ≥ 0.90  
   - Stage 2: Adjusted Rand Index ≥ 0.60, silhouette score ≥ 0.5  

---

## 3. Exploratory Data Analysis & Cleaning (26 pts)  

### 3.1 Visual Inspection  
- Select 5 random samples from each folder (`noise/`, `signal_type_{1–7}/`)  
- Display with `matplotlib.pyplot.imshow()`  
- Observe image size, dynamic range, noise patterns  

### 3.2 Statistical Summaries  
- **Pixel histograms**:  
```python
import numpy as np
all_pixels = np.concatenate([img.flatten() for img in images])
plt.hist(all_pixels, bins=50)
```
- Per-class stats: mean, std, skewness, kurtosis  

### 3.3 Preprocessing & Feature Extraction  
1. **Resize & normalize**  
   - Target shape: 64×64  
   - Code snippet in src/preprocess.py:  
```python
from PIL import Image
def resize_and_scale(path):
    im = Image.open(path).convert('L')
    im = im.resize((64,64))
    arr = np.array(im) / 255.0
    return arr
```

2. **Flattened-pixel features**  
   - Each image → 4,096-dim vector  

3. **Spectral-band summaries**  
   - Divide 64 rows into 8 bands of 8 pixels each  
   - Compute mean & variance per band → 16 features  
   - Example in src/features.py  

4. **Optional handcrafted stats**  
   - Global max, min, median, interquartile range  

### 3.4 Missing / Corrupt Data  
- Log files that fail to open or have zero size  
- Drop or move to data/processed/bad/  

### 3.5 Transformations & Scaling  
- Log-scale: X = np.log1p(X) if skewed  
- Standardization:  
```python
from sklearn.preprocessing import StandardScaler
scaler = StandardScaler().fit(X_train)
X_train_scaled = scaler.transform(X_train)
```

### 3.6 Quick Dimensionality Reduction (EDA)  
- PCA to 2D:  
```python
from sklearn.decomposition import PCA
pca2 = PCA(n_components=2).fit_transform(X_scaled)
plt.scatter(pca2[:,0], pca2[:,1], s=5, c=labels)
```
- t-SNE / UMAP preview (subset of data)  

---

## 4. Model Building & Analysis (70 pts)  

### 4.1 Stage 1: Anomaly Detection (Noise vs. Signal)  
1. **Train/Test Split**  
   - Use only noise for training (80/20 split)  
   - Hold-out: all signals + remaining noise  

2. **Isolation Forest (example classical method)**  
```python
from sklearn.ensemble import IsolationForest
iso = IsolationForest(contamination=0.1).fit(X_noise_train)
scores = -iso.decision_function(X_holdout)
```

3. **One-Class SVM (optional)**  

4. **Evaluation**  
   - Compute ROC AUC:  
```python
from sklearn.metrics import roc_auc_score
y_true = [0]*len(noise_test) + [1]*len(signal_test)
auc = roc_auc_score(y_true, scores)
```
   - Plot ROC curve & error histograms  

### 4.2 Stage 2: Clustering of Signal Types  
1. **Embedding Preparation**  
   - Use scaled features or PCA projection (n_components=50)  

2. **K-Means**  
```python
from sklearn.cluster import KMeans
km = KMeans(n_clusters=7).fit(X_signals)
preds = km.labels_
```

3. **Hierarchical Clustering**  
```python
from scipy.cluster.hierarchy import linkage, fcluster
Z = linkage(X_signals_pca, method='ward')
clusters = fcluster(Z, t=7, criterion='maxclust')
```

4. **DBSCAN (density-based)**  
   - Determine ε via k-distance plot  

5. **Cluster Evaluation**  
```python
from sklearn.metrics import adjusted_rand_score, silhouette_score
ari = adjusted_rand_score(true_labels, preds)
sil = silhouette_score(X_signals_pca, preds)
```

6. **Visualization**  
   - 2D UMAP: color by true vs. predicted clusters  
   - Confusion matrix of true vs. cluster labels  

### 4.3 Matrix Factorization on Images  
1. **SVD on Image Stack**  
```python
import numpy as np
A = X_flattened  # shape: (N, 4096)
U, S, VT = np.linalg.svd(A, full_matrices=False)
```

2. **NMF**  
```python
from sklearn.decomposition import NMF
nmf = NMF(n_components=10).fit(A)
W = nmf.transform(A)
H = nmf.components_
```

3. **Interpretation**  
   - Visualize top-3 "basis" vectors as 64×64 images  

### 4.4 Similarity Measures & Graphs  
- Cosine similarity matrix: cluster via spectral methods  
- Jaccard on binary-thresholded pixels  

---

## 5. Deliverables & Structure (35 pts)  

### 5.1 Notebooks (/notebooks/)  
- `01_data_ingestion_and_eda.ipynb` → Step 1–3  
- `02_anomaly_detection.ipynb` → Stage 1  
- `03_signal_clustering.ipynb` → Stage 2  
- `04_matrix_factorization.ipynb` → SVD/NMF & similarity  

### 5.2 Source Code (/src/)  
- `load_data.py`  
- `preprocess.py`  
- `features.py`  
- `models/anomaly.py`  
- `models/clustering.py`  
- `models/factorization.py`  
- `utils/plots.py`  

### 5.3 Outputs (/outputs/)  
- Figures (histograms, scatter plots, ROC curves)  
- CSV of cluster assignments & evaluation metrics  

### 5.4 Video Presentation (~10 min)  
1. Motivation & Data (what SETI is, spectrogram nature)  
2. EDA Highlights (images, histograms, PCA preview)  
3. Anomaly Detection Demo (isolation forest / one-class SVM results)  
4. Clustering Demo (UMAP + cluster coloring, ARI)  
5. Matrix Factorization Insights (basis images)  
6. Conclusions & Future Work  

### 5.5 GitHub Repository Layout  
```
/data/
  raw/
  processed/
/notebooks/
/src/
/outputs/
/slides/          # optional  
video_link.txt  
README.md         # overview & setup  
requirements.txt  
```

Tip: In your README include environment setup (conda/pip), Kaggle API setup, and step-by-step "Run this notebook first" instructions.

